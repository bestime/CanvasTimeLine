/**  
 * CanvasTimeLineTheme02.esm.min.js
 * @QQ 1174295440
 * @update 2023-03-30 17:44:10
 */
function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,_toPropertyKey(n.key),n)}}function _createClass(t,e,r){return e&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPrimitive(t,e){if("object"!=typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(r===undefined)return("string"===e?String:Number)(t);t=r.call(t,e||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toPropertyKey(t){t=_toPrimitive(t,"string");return"symbol"==typeof t?t:String(t)}function isNull(t){return null===t||t===undefined}function _String(t){return isNull(t)?"":String(t)}var $ArrayTypeNameBig="Array",$FunctionTypeNameBig="Function",$ObjectTypeNameBig="Object",$ObjectTypeNameBigPrototypeToString=Object.prototype.toString;function getType(t){return $ObjectTypeNameBigPrototypeToString.call(t).slice(8,-1)}function hpIsEmptyMap(t){var e,r=!0;for(e in t)if(e!==undefined){r=!1;break}return r}function cloneEasy(t){switch(getType(t)){case $ArrayTypeNameBig:for(var e=[],r=0;r<t.length;r++)e.push(cloneEasy(t[r]));break;case $ObjectTypeNameBig:for(var n in e={},t)e[n]=cloneEasy(t[n]);break;case $FunctionTypeNameBig:function i(){t.apply(this,arguments)}for(var o in t.prototype)i.prototype[o]=t.prototype[o];e=i;break;default:e=t}return e}function repeatString(t,e){var r="";if((t=_String(t)).length*e<1<<28)for(;1==(1&e)&&(r+=t),0!=(e>>>=1);)t+=t;return r}function hpPadString(t,e,r,n){return(t=_String(t)).length>(e>>=0)?t:(e-=t.length,r.length<e&&(r+=repeatString(r,e/r.length)),-1===n?r.slice(0,e)+t:t+r.slice(0,e))}function padStart(t,e,r){return hpPadString(t,e,r,-1)}document.getElementsByTagName("head")[0];var timer,htivId=0,idName="",isStart=!1,records={};function stop(){isStart=!1,clearInterval(timer),timer=undefined}function startRun(){clearInterval(timer),isStart=!0,timer=setInterval(function(){for(var t in records){var e=records[t];e.current=+new Date,e.current-e.start>=e.interval&&(e.start=e.current,records[t].handler())}},17)}function add(t,e){return idName="HI-"+ ++htivId,records[idName]={start:+new Date,current:0,handler:t,interval:e},isStart||startRun(),idName}function remove(t){delete records[t],hpIsEmptyMap(records)&&stop()}var hpInterval={add:add,remove:remove},main$2=function(r,n,i,t){var o=[0,0,!1],a=[0,0,!1],s=[0,0,!1],c=[0,0,!1],e=hpInterval.add(u,t=t||500);function u(){var t,e;document.body.contains(r)?(t=!1,null!=i&&i.includes("position")&&(e=r.getBoundingClientRect(),s[0]=e.left,s[2]=s[0]!==s[1],c[0]=e.top,c[2]=c[0]!==c[1]),o[0]=r.offsetWidth,o[2]=o[0]!==o[1],a[0]=r.offsetHeight,a[2]=a[0]!==a[1],o[2]&&(o[1]=o[0],null!=i)&&i.includes("width")&&(t=!0),a[2]&&(a[1]=a[0],null!=i)&&i.includes("height")&&(t=!0),(c[2]||s[2])&&(c[1]=c[0],s[1]=s[0],null!=i)&&i.includes("position")&&(t=!0),i&&0!==i.length||(o[2]||a[2]||c[2]||s[2])&&(t=!0),t&&n(r)):h()}function h(){hpInterval.remove(e),o=undefined,a=undefined}return u(),h},freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeGlobal$1=freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")(),root$1=root,Symbol$1=root$1.Symbol,Symbol$2=Symbol$1,objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty,nativeObjectToString$1=objectProto$a.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:undefined;function getRawTag(t){var e=hasOwnProperty$8.call(t,symToStringTag$1),r=t[symToStringTag$1];try{t[symToStringTag$1]=undefined;var n=!0}catch(o){}var i=nativeObjectToString$1.call(t);return n&&(e?t[symToStringTag$1]=r:delete t[symToStringTag$1]),i}var objectProto$9=Object.prototype,nativeObjectToString=objectProto$9.toString;function objectToString(t){return nativeObjectToString.call(t)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:undefined;function baseGetTag(t){return null==t?t===undefined?undefinedTag:nullTag:(symToStringTag&&symToStringTag in Object(t)?getRawTag:objectToString)(t)}function isObjectLike(t){return null!=t&&"object"==typeof t}var symbolTag="[object Symbol]";function isSymbol(t){return"symbol"==typeof t||isObjectLike(t)&&baseGetTag(t)==symbolTag}var isArray=Array.isArray,isArray$1=isArray,reWhitespace=/\s/;function trimmedEndIndex(t){for(var e=t.length;e--&&reWhitespace.test(t.charAt(e)););return e}var reTrimStart=/^\s+/;function baseTrim(t){return t&&t.slice(0,trimmedEndIndex(t)+1).replace(reTrimStart,"")}function isObject(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(t){if("number"==typeof t)return t;if(isSymbol(t))return NAN;if("string"!=typeof(t=isObject(t)?isObject(e="function"==typeof t.valueOf?t.valueOf():t)?e+"":e:t))return 0===t?t:+t;t=baseTrim(t);var e=reIsBinary.test(t);return e||reIsOctal.test(t)?freeParseInt(t.slice(2),e?2:8):reIsBadHex.test(t)?NAN:+t}function identity(t){return t}var asyncTag="[object AsyncFunction]",funcTag$1="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(t){return!!isObject(t)&&((t=baseGetTag(t))==funcTag$1||t==genTag||t==asyncTag||t==proxyTag)}var coreJsData=root$1["__core-js_shared__"],coreJsData$1=coreJsData,maskSrcKey=function(){var t=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function isMasked(t){return!!maskSrcKey&&maskSrcKey in t}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(t){if(null!=t){try{return funcToString$2.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$8=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$7=objectProto$8.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$7).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(t){return!(!isObject(t)||isMasked(t))&&(isFunction(t)?reIsNative:reIsHostCtor).test(toSource(t))}function getValue(t,e){return null==t?undefined:t[e]}function getNative(t,e){t=getValue(t,e);return baseIsNative(t)?t:undefined}var objectCreate=Object.create,baseCreate=function(){function e(){}return function(t){if(!isObject(t))return{};if(objectCreate)return objectCreate(t);e.prototype=t;t=new e;return e.prototype=undefined,t}}(),baseCreate$1=baseCreate;function apply(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}function copyArray(t,e){var r=-1,n=t.length;for(e=e||Array(n);++r<n;)e[r]=t[r];return e}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(r){var n=0,i=0;return function(){var t=nativeNow(),e=HOT_SPAN-(t-i);if(i=t,0<e){if(++n>=HOT_COUNT)return arguments[0]}else n=0;return r.apply(undefined,arguments)}}function constant(t){return function(){return t}}var defineProperty=function(){try{var t=getNative(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),defineProperty$1=defineProperty,baseSetToString=defineProperty$1?function(t,e){return defineProperty$1(t,"toString",{configurable:!0,enumerable:!1,value:constant(e),writable:!0})}:identity,baseSetToString$1=baseSetToString,setToString=shortOut(baseSetToString),setToString$1=setToString,MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(t,e){var r=typeof t;return!!(e=null==e?MAX_SAFE_INTEGER$1:e)&&("number"==r||"symbol"!=r&&reIsUint.test(t))&&-1<t&&t%1==0&&t<e}function baseAssignValue(t,e,r){"__proto__"==e&&defineProperty$1?defineProperty$1(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function eq(t,e){return t===e||t!=t&&e!=e}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function assignValue(t,e,r){var n=t[e];hasOwnProperty$6.call(t,e)&&eq(n,r)&&(r!==undefined||e in t)||baseAssignValue(t,e,r)}function copyObject(t,e,r,n){for(var i=!r,o=(r=r||{},-1),a=e.length;++o<a;){var s=e[o],c=n?n(r[s],t[s],s,r,t):undefined;(i?baseAssignValue:assignValue)(r,s,c=c===undefined?t[s]:c)}return r}var nativeMax$1=Math.max;function overRest(o,a,s){return a=nativeMax$1(a===undefined?o.length-1:a,0),function(){for(var t=arguments,e=-1,r=nativeMax$1(t.length-a,0),n=Array(r);++e<r;)n[e]=t[a+e];for(var e=-1,i=Array(a+1);++e<a;)i[e]=t[e];return i[a]=s(n),apply(o,this,i)}}function baseRest(t,e){return setToString$1(overRest(t,e,identity),t+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=MAX_SAFE_INTEGER}function isArrayLike(t){return null!=t&&isLength(t.length)&&!isFunction(t)}function isIterateeCall(t,e,r){var n;return!!isObject(r)&&!!("number"==(n=typeof e)?isArrayLike(r)&&isIndex(e,r.length):"string"==n&&e in r)&&eq(r[e],t)}function createAssigner(s){return baseRest(function(t,e){var r=-1,n=e.length,i=1<n?e[n-1]:undefined,o=2<n?e[2]:undefined,i=3<s.length&&"function"==typeof i?(n--,i):undefined;for(o&&isIterateeCall(e[0],e[1],o)&&(i=n<3?undefined:i,n=1),t=Object(t);++r<n;){var a=e[r];a&&s(t,a,r,i)}return t})}var objectProto$6=Object.prototype;function isPrototype(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||objectProto$6)}function baseTimes(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var argsTag$1="[object Arguments]";function baseIsArguments(t){return isObjectLike(t)&&baseGetTag(t)==argsTag$1}var objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty,propertyIsEnumerable=objectProto$5.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(t){return isObjectLike(t)&&hasOwnProperty$5.call(t,"callee")&&!propertyIsEnumerable.call(t,"callee")},isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root$1.Buffer:undefined,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:undefined,isBuffer=nativeIsBuffer||stubFalse,isBuffer$1=isBuffer,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag$1="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(t){return isObjectLike(t)&&isLength(t.length)&&!!typedArrayTags[baseGetTag(t)]}function baseUnary(e){return function(t){return e(t)}}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag$1]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil=function(){try{var t=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return t?t:freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeUtil$1=nodeUtil,nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,isTypedArray$1=isTypedArray,objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function arrayLikeKeys(t,e){var r,n=isArray$1(t),i=!n&&isArguments$1(t),o=!n&&!i&&isBuffer$1(t),a=!n&&!i&&!o&&isTypedArray$1(t),s=n||i||o||a,c=s?baseTimes(t.length,String):[],u=c.length;for(r in t)!e&&!hasOwnProperty$4.call(t,r)||s&&("length"==r||o&&("offset"==r||"parent"==r)||a&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||isIndex(r,u))||c.push(r);return c}function overArg(e,r){return function(t){return e(r(t))}}function nativeKeysIn(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}var objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function baseKeysIn(t){if(!isObject(t))return nativeKeysIn(t);var e,r=isPrototype(t),n=[];for(e in t)("constructor"!=e||!r&&hasOwnProperty$3.call(t,e))&&n.push(e);return n}function keysIn(t){return isArrayLike(t)?arrayLikeKeys(t,!0):baseKeysIn(t)}var nativeCreate=getNative(Object,"create"),nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(t){t=this.has(t)&&delete this.__data__[t];return this.size-=t?1:0,t}var HASH_UNDEFINED$1="__lodash_hash_undefined__",objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function hashGet(t){var e,r=this.__data__;return nativeCreate$1?(e=r[t])===HASH_UNDEFINED$1?undefined:e:hasOwnProperty$2.call(r,t)?r[t]:undefined}var objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function hashHas(t){var e=this.__data__;return nativeCreate$1?e[t]!==undefined:hasOwnProperty$1.call(e,t)}var HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=nativeCreate$1&&e===undefined?HASH_UNDEFINED:e,this}function Hash(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(t,e){for(var r=t.length;r--;)if(eq(t[r][0],e))return r;return-1}Hash.prototype.clear=hashClear,Hash.prototype["delete"]=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(t){var e=this.__data__,t=assocIndexOf(e,t);return!(t<0||(t==e.length-1?e.pop():splice.call(e,t,1),--this.size,0))}function listCacheGet(t){var e=this.__data__,t=assocIndexOf(e,t);return t<0?undefined:e[t][1]}function listCacheHas(t){return-1<assocIndexOf(this.__data__,t)}function listCacheSet(t,e){var r=this.__data__,n=assocIndexOf(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}function ListCache(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype["delete"]=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map=getNative(root$1,"Map"),Map$1=Map;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}function getMapData(t,e){t=t.__data__;return isKeyable(e)?t["string"==typeof e?"string":"hash"]:t.map}function mapCacheDelete(t){t=getMapData(this,t)["delete"](t);return this.size-=t?1:0,t}function mapCacheGet(t){return getMapData(this,t).get(t)}function mapCacheHas(t){return getMapData(this,t).has(t)}function mapCacheSet(t,e){var r=getMapData(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}function MapCache(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype["delete"]=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var getPrototype=overArg(Object.getPrototypeOf,Object),getPrototype$1=getPrototype,objectTag="[object Object]",funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(t){return!(!isObjectLike(t)||baseGetTag(t)!=objectTag)&&(null===(t=getPrototype$1(t))||"function"==typeof(t=hasOwnProperty.call(t,"constructor")&&t.constructor)&&t instanceof t&&funcToString.call(t)==objectCtorString)}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(t){var e=this.__data__,t=e["delete"](t);return this.size=e.size,t}function stackGet(t){return this.__data__.get(t)}function stackHas(t){return this.__data__.has(t)}var LARGE_ARRAY_SIZE=200;function stackSet(t,e){var r=this.__data__;if(r instanceof ListCache){var n=r.__data__;if(!Map$1||n.length<LARGE_ARRAY_SIZE-1)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new MapCache(n)}return r.set(t,e),this.size=r.size,this}function Stack(t){t=this.__data__=new ListCache(t);this.size=t.size}Stack.prototype.clear=stackClear,Stack.prototype["delete"]=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root$1.Buffer:undefined,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined;function cloneBuffer(t,e){return e?t.slice():(e=t.length,e=allocUnsafe?allocUnsafe(e):new t.constructor(e),t.copy(e),e)}var Uint8Array=root$1.Uint8Array,Uint8Array$1=Uint8Array;function cloneArrayBuffer(t){var e=new t.constructor(t.byteLength);return new Uint8Array$1(e).set(new Uint8Array$1(t)),e}function cloneTypedArray(t,e){e=e?cloneArrayBuffer(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}function initCloneObject(t){return"function"!=typeof t.constructor||isPrototype(t)?{}:baseCreate$1(getPrototype$1(t))}function createBaseFor(c){return function(t,e,r){for(var n=-1,i=Object(t),o=r(t),a=o.length;a--;){var s=o[c?a:++n];if(!1===e(i[s],s,i))break}return t}}var baseFor=createBaseFor(),baseFor$1=baseFor,now=function(){return root$1.Date.now()},now$1=now,FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(n,r,t){var i,o,a,s,c,u,h=0,l=!1,p=!1,e=!0;if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);function f(t){var e=i,r=o;return i=o=undefined,h=t,s=n.apply(r,e)}function d(t){var e=t-u;return u===undefined||r<=e||e<0||p&&a<=t-h}function y(){var t,e=now$1();if(d(e))return _(e);c=setTimeout(y,(t=r-((e=e)-u),p?nativeMin(t,a-(e-h)):t))}function _(t){return c=undefined,e&&i?f(t):(i=o=undefined,s)}function g(){var t=now$1(),e=d(t);if(i=arguments,o=this,u=t,e){if(c===undefined)return h=t=u,c=setTimeout(y,r),l?f(t):s;if(p)return clearTimeout(c),c=setTimeout(y,r),f(u)}return c===undefined&&(c=setTimeout(y,r)),s}return r=toNumber(r)||0,isObject(t)&&(l=!!t.leading,p="maxWait"in t,a=p?nativeMax(toNumber(t.maxWait)||0,r):a,e="trailing"in t?!!t.trailing:e),g.cancel=function(){c!==undefined&&clearTimeout(c),h=0,i=u=o=c=undefined},g.flush=function(){return c===undefined?s:_(now$1())},g}function assignMergeValue(t,e,r){(r===undefined||eq(t[e],r))&&(r!==undefined||e in t)||baseAssignValue(t,e,r)}function isArrayLikeObject(t){return isObjectLike(t)&&isArrayLike(t)}function safeGet(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function toPlainObject(t){return copyObject(t,keysIn(t))}function baseMergeDeep(t,e,r,n,i,o,a){var s,c,u,h=safeGet(t,r),l=safeGet(e,r),p=a.get(l);p||((e=(p=o?o(h,l,r+"",t,e,a):undefined)===undefined)&&(c=!(s=isArray$1(l))&&isBuffer$1(l),u=!s&&!c&&isTypedArray$1(l),p=l,s||c||u?p=isArray$1(h)?h:isArrayLikeObject(h)?copyArray(h):c?cloneBuffer(l,!(e=!1)):u?cloneTypedArray(l,!(e=!1)):[]:isPlainObject(l)||isArguments$1(l)?isArguments$1(p=h)?p=toPlainObject(h):isObject(h)&&!isFunction(h)||(p=initCloneObject(l)):e=!1),e&&(a.set(l,p),i(p,l,n,o,a),a["delete"](l))),assignMergeValue(t,r,p)}function baseMerge(n,i,o,a,s){n!==i&&baseFor$1(i,function(t,e){var r;s=s||new Stack,isObject(t)?baseMergeDeep(n,i,e,o,baseMerge,a,s):((r=a?a(safeGet(n,e),t,e+"",n,i,s):undefined)===undefined&&(r=t),assignMergeValue(n,e,r))},keysIn)}var mergeWith=createAssigner(function(t,e,r,n){baseMerge(t,e,r,n)}),mergeWith$1=mergeWith;function last(t){var e=null==t?0:t.length;return e?t[e-1]:undefined}function head(t){return t&&t.length?t[0]:undefined}function convertTime(t){t=new Date(t);return{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),milliSecond:t.getMilliseconds()}}function convertList(t,e){for(var r={},n=0;n<t.length;n++){var i=t[n],o=convertTime(new Date(i).getTime()),a="";"year"===e?a=""+o.year:"month"===e?a=o.year+"-"+o.month:"day"===e?a=o.year+"-"+o.month+"-"+o.day:"hour"===e?a=o.year+"-"+o.month+"-"+o.day+" "+o.hour:"minute"===e&&(a=o.year+"-"+o.month+"-"+o.day+" "+o.hour+":"+o.minute),r[a]||(r[a]={value:i,data:[]}),r[a].data.push(i)}var s,c=[];for(s in r)c.push(r[s]);return c.sort(function(t,e){return new Date(t.value).getTime()-new Date(e.value).getTime()}),c}var CanvasTimeLineTheme02=function(){function t(t,e){var r=this,n=(this._times=[],this._options=void 0,this._canvas=void 0,this._ctx=void 0,this._element=void 0,this._pressX=0,this._currentWidth=0,this._originTimes=[],this._offsetX={pre:0,current:0},this._currentPopper=void 0,this._previewPopper=void 0,this._playBtn=void 0,this._canvasRoom=void 0,this._bodyPopper=void 0,this.currentTime="",this._locking=!1,this._timerAuto=void 0,this._timerObv=void 0,this._mousein=!1,this._canvasHeight=0,this._obvHandler=void 0,t.classList.add("canvas-timeLine-theme02"),this._onMouesmove=this._onMouesmove.bind(this),this._onMouseup=this._onMouseup.bind(this),document.createElement("canvas"));this._currentPopper=document.createElement("div"),this._currentPopper.className="current",this._previewPopper=document.createElement("div"),this._previewPopper.className="preview",this._playBtn=document.createElement("div"),this._playBtn.innerText="播放",this._playBtn.className="play",this._canvasRoom=document.createElement("div"),this._canvasRoom.className="canvas-room",this._element=t,this._bodyPopper=document.createElement("div"),this._bodyPopper.className="body",this._canvas=n,this._ctx=n.getContext("2d"),this._options=mergeWith$1({scale:{type:"day",height:6,lineColor:"#fff",fontColor:"#fff",space:70,bottom:4,font:{size:12,family:"Microsoft YaHei"}},autoplay:{enabled:!1,interval:60},progress:{size:6,backgroundActiveColor:"#4492d5",backgroundStaticColor:"#35323f"},label:{}},e),this._canvasHeight=this._options.scale.font.size+this._options.scale.bottom+this._options.scale.height+this._options.progress.size,this._initDrag(),t.appendChild(this._bodyPopper),this._bodyPopper.appendChild(this._playBtn),this._canvasRoom.appendChild(n),this._bodyPopper.appendChild(this._canvasRoom),this._bodyPopper.appendChild(this._currentPopper),this._bodyPopper.appendChild(this._previewPopper),this._obvHandler=main$2(this._element,function(){r._canvas.style.width=r._times.length*r._options.scale.space+"px",clearTimeout(r._timerObv),r._timerObv=setTimeout(function(){r._scrollToCurrent()},30)},["width","position"],100),this._playBtn.onclick=function(){return r._options.autoplay.enabled?r.stop():r.play(),r},this._options.autoplay.enabled&&0<this._options.autoplay.interval&&this.play(),this._canvasRoom.style.borderTopWidth=(this._playBtn.offsetHeight-this._options.progress.size)/2+"px"}var e=t.prototype;return e.play=function(){return clearTimeout(this._timerAuto),this._options.autoplay.enabled=!0,this._playBtn.innerHTML="暂停",this._bodyPopper.classList.add("playing"),this._checkAutoPlay(),this},e.stop=function stop(){return clearTimeout(this._timerAuto),this._options.autoplay.enabled=!1,this._playBtn.innerHTML="播放",this._bodyPopper.classList.remove("playing"),this},e._checkAutoPlay=function(){var e=this;clearTimeout(this._timerAuto),this._options.autoplay.enabled&&!this._mousein&&0<this._options.autoplay.interval&&(this._timerAuto=setTimeout(function(){var t=e._findNextTime();e.setDateTime(t,!1)},this._options.autoplay.interval))},e._getPrevTime=function(){for(var t="",e=this._times.length-1;0<=e;e--)for(var r=this._times[e].data.length-1;0<=r;r--)this._times[e].data[r]===this.currentTime&&(t=0===r?0===e?this.currentTime:last(this._times[e-1].data):this._times[e].data[r-1]);return t},e._getNextTime=function(){for(var t="",e=0;e<this._times.length;e++)for(var r=0;r<this._times[e].data.length;r++)this._times[e].data[r]===this.currentTime&&(t=r===this._times[e].data.length-1?e===this._times.length-1?this.currentTime:this._times[e+1].data[0]:this._times[e].data[r+1]);return t},e._findNextTime=function(){for(var t="",e=0;e<this._times.length;e++)for(var r=0;r<this._times[e].data.length;r++)this._times[e].data[r]===this.currentTime&&(t=r===this._times[e].data.length-1?(e===this._times.length-1?this._times[0]:this._times[e+1]).data[0]:this._times[e].data[r+1]);return t},e._onMouseup=function(){this._offsetX.pre=this._offsetX.current,document.removeEventListener("mouseup",this._onMouseup),document.removeEventListener("mousemove",this._onMouesmove)},e._onMouesmove=function(t){var t=t.clientX-this._pressX,e=t+this._offsetX.pre+this._minLeftSpace;t<0?(t=Math.max(e,-(this._getMaxWidth()-this._canvasRoom.offsetWidth)),this._offsetX.current=Math.min(t,0)):this._offsetX.current=Math.min(e,0),this.draw()},e._initDrag=function(){var r=this;this._canvas.onmousedown=function(t){r._mousein=!0,r._pressX=t.clientX+r._minLeftSpace,document.removeEventListener("mouseup",r._onMouseup),document.removeEventListener("mousemove",r._onMouesmove),document.addEventListener("mouseup",r._onMouseup),document.addEventListener("mousemove",r._onMouesmove)},this._canvas.onmousemove=function(t){r._mousein=!0;var e,t=r.getMouseDatetime(t.clientX,r._currentWidth);t?(e=r._getCurrentLeft(t)+r._offsetX.current,r._previewPopper.innerText=r._options.label.formatter?r._options.label.formatter(t):t,r._previewPopper.style.display="block",t=r._canvas.getBoundingClientRect(),r._previewPopper.style.left=t.left+e-r._previewPopper.offsetWidth/2+"px",r._previewPopper.style.top=t.top-r._previewPopper.offsetHeight-8+"px"):r._previewPopper.style.display="none"},this._canvas.onmouseout=this._canvas.onmouseleave=debounce(function(){r._previewPopper.style.display="none",r._mousein=!1,r._checkAutoPlay()},200),this._canvas.ondblclick=function(t){t=r.getMouseDatetime(t.clientX,r._currentWidth);t&&r.setDateTime(t,!0)}},e._getCurrentLeft=function(t){for(var e=0,r=!1,n=0;n<this._times.length;n++){for(var i=0;i<this._times[n].data.length;i++)if(this._times[n].data[i]===t){var o=this._times[n].data.length;n===this._times.length-1&&(o=Math.max(o-1,1)),e=n*this._options.scale.space+this._options.scale.space/o*i,r=!0;break}if(r)break}return e},e.setData=function(t){return(t=cloneEasy(t)).sort(function(t,e){return new Date(t).getTime()-new Date(e).getTime()}),this._originTimes=t,this._times=convertList(t,this._options.scale.type),t.length&&(this._canvas.style.width=this._times.length*this._options.scale.space+"px",this.setDateTime(head(t),!1)),this},e.draw=function(){null!=(t=this._options)&&null!=(e=t.beforeDraw)&&e.call(t);var t=this._getMaxWidth(),e=this._canvasRoom.offsetWidth;this._canvasRoom.offsetWidth>t&&(e=t,this._offsetX.current=0,this._offsetX.pre=0),this._canvas.width=e,this._canvas.height=this._canvasHeight,this._canvas.style.width=e+"px",this._canvas.style.height=this._canvasHeight+"px",this._canvasRoom.style.height=this._canvasHeight+"px",this._ctx.fillStyle="transparent",this._ctx.fillRect(0,0,e,this._canvasHeight),this._drawProgress(),this._drawScales()},e._formatScale=function(t){var e;return this._options.scale.formatter?this._options.scale.formatter(t):(e=convertTime(new Date(t).getTime()),"year"===this._options.scale.type?padStart(e.year,4,"0")+"年":"month"===this._options.scale.type?padStart(e.year,4,"0")+"年"+padStart(e.month,2,"0")+"月":"day"===this._options.scale.type?padStart(e.month,2,"0")+"月"+padStart(e.day,2,"0")+"日":"hour"===this._options.scale.type?padStart(e.day,2,"0")+"日"+padStart(e.hour,2,"0")+"时":"minute"===this._options.scale.type?padStart(e.hour,2,"0")+"时"+padStart(e.minute,2,"0")+"分":t)},e.getMouseDatetime=function(t,e){var r,n=this._canvas.getBoundingClientRect(),t=Math.round(t-n.left)-this._offsetX.current,n=Math.floor(t/this._options.scale.space),i=this._times[n];if(i)return r=0,t<e?r=Math.floor(t%this._options.scale.space/(this._options.scale.space/i.data.length)):(r=Math.ceil(t%this._options.scale.space/(this._options.scale.space/i.data.length)))>i.data.length-1&&(r=0,i=this._times[++n]),null!=(e=i)&&null!=(t=e.data)&&t[r]||(n=this._times.length-1,r=(i=this._times[n]).data.length-1),i.data[r]},e._getMaxWidth=function(){var t,e=this._times.length*this._options.scale.space;return 1===(null==(t=last(this._times))?void 0:t.data.length)&&(e-=this._options.scale.space),e},e._drawProgress=function(){this._getMaxWidth();var t=this._getCurrentLeft(this.currentTime),t=(this._currentWidth=t)+this._offsetX.current,e=this._options.progress.size/2,r=(this._ctx.beginPath(),this._ctx.lineWidth=this._options.progress.size,this._ctx.lineCap="round",this._ctx.strokeStyle=this._options.progress.backgroundStaticColor,this._ctx.moveTo(e,e),this._ctx.lineTo(this._canvas.offsetWidth-e,e),this._ctx.stroke(),this._ctx.closePath(),t);0<=r&&(r-=e,this._ctx.beginPath(),this._ctx.lineWidth=this._options.progress.size,this._ctx.strokeStyle=this._options.progress.backgroundActiveColor,this._ctx.moveTo(e,e),this._ctx.lineTo(Math.max(r,e),e),this._ctx.stroke(),this._ctx.closePath()),this.currentTime&&t<=this._canvasRoom.offsetWidth&&0<=t?(this._currentPopper.style.display="block",this._currentPopper.innerText=this._options.label.formatter?this._options.label.formatter(this.currentTime):this.currentTime,r=this._canvas.getBoundingClientRect(),this._currentPopper.style.left=r.left+t-this._currentPopper.offsetWidth/2+"px",this._currentPopper.style.top=r.top-this._currentPopper.offsetHeight-8+"px"):this._currentPopper.style.display="none"},e._drawScales=function(){this._ctx.lineCap="butt";for(var t,e,r,n=1;n<this._times.length;n++)n===this._times.length-1&&1===(null==(t=last(this._times))?void 0:t.data.length)||(this._ctx.beginPath(),this._ctx.lineWidth=1,this._ctx.strokeStyle=this._options.scale.lineColor,t=this._options.scale.space*n-.5+this._offsetX.current,this._ctx.moveTo(t,0+this._options.progress.size),this._ctx.lineTo(t,this._options.scale.height+this._options.progress.size),this._ctx.stroke(),this._ctx.closePath(),this._ctx.beginPath(),this._ctx.textBaseline="ideographic",this._ctx.fillStyle=this._options.scale.fontColor,this._ctx.font=this._options.scale.font.size+"px "+this._options.scale.font.family,e=this._formatScale(this._times[n].value),r=this._ctx.measureText(e).width,this._ctx.fillText(e,t-Math.floor(r/2),this._canvasHeight),this._ctx.closePath())},e._scrollToCurrent=function(){var t=this._getCurrentLeft(this.currentTime)-this._options.progress.size/2;this._pressX=0,this._offsetX.pre=0,this._offsetX.current=this._offsetX.pre,this._onMouesmove({clientX:-t}),this._offsetX.pre=this._offsetX.current},e.setDateTime=function(e,t){var r=this;if(!this.currentTime||this.currentTime!==e)return this._locking?console.error('时间设置失败： "'+e+'"。上一个切换未完成！'):this._originTimes.some(function(t){return t===e})?(this.currentTime=e,t?this.draw():this._scrollToCurrent(),null!=(t=this._options)&&t.onChange&&(this._locking=!0,t={value:this.currentTime,start:head(this._originTimes),end:last(this._originTimes),prev:this._getPrevTime(),next:this._getNextTime()},this._options.onChange(t,function(){r._locking=!1,r._checkAutoPlay()}))):console.error('时间设置失败： "'+e+'" 不在列表中'),this},e.dispose=function(){this._obvHandler(),clearTimeout(this._timerObv),clearTimeout(this._timerAuto),document.removeEventListener("mouseup",this._onMouseup),document.removeEventListener("mousemove",this._onMouesmove)},_createClass(t,[{key:"_minLeftSpace",get:function(){var t;return null!=(t=this._options.label.leftSpace)?t:Math.floor(this._canvas.offsetWidth/2)}}]),t}();export{CanvasTimeLineTheme02 as default};
