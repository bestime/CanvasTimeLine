/**  
 * CanvasTimeLineTheme02.esm.min.js
 * @QQ 1174295440
 * @update 2023-03-31 18:16:41
 */
function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPrimitive(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(r===undefined)return("string"===t?String:Number)(e);e=r.call(e,t||"default");if("object"!=typeof e)return e;throw new TypeError("@@toPrimitive must return a primitive value.")}function _toPropertyKey(e){e=_toPrimitive(e,"string");return"symbol"==typeof e?e:String(e)}function isNull(e){return null===e||e===undefined}function _String(e){return isNull(e)?"":String(e)}var $ArrayTypeNameBig="Array",$FunctionTypeNameBig="Function",$ObjectTypeNameBig="Object",$ObjectTypeNameBigPrototypeToString=Object.prototype.toString;function getType(e){return $ObjectTypeNameBigPrototypeToString.call(e).slice(8,-1)}function hpIsEmptyMap(e){var t,r=!0;for(t in e)if(t!==undefined){r=!1;break}return r}function cloneEasy(e){switch(getType(e)){case $ArrayTypeNameBig:for(var t=[],r=0;r<e.length;r++)t.push(cloneEasy(e[r]));break;case $ObjectTypeNameBig:for(var n in t={},e)t[n]=cloneEasy(e[n]);break;case $FunctionTypeNameBig:function i(){e.apply(this,arguments)}for(var a in e.prototype)i.prototype[a]=e.prototype[a];t=i;break;default:t=e}return t}function repeatString(e,t){var r="";if((e=_String(e)).length*t<1<<28)for(;1==(1&t)&&(r+=e),0!=(t>>>=1);)e+=e;return r}function hpPadString(e,t,r,n){return(e=_String(e)).length>(t>>=0)?e:(t-=e.length,r.length<t&&(r+=repeatString(r,t/r.length)),-1===n?r.slice(0,t)+e:e+r.slice(0,t))}function padStart(e,t,r){return hpPadString(e,t,r,-1)}document.getElementsByTagName("head")[0];var timer,htivId=0,idName="",isStart=!1,records={};function stop(){isStart=!1,clearInterval(timer),timer=undefined}function startRun(){clearInterval(timer),isStart=!0,timer=setInterval(function(){for(var e in records){var t=records[e];t.current=+new Date,t.current-t.start>=t.interval&&(t.start=t.current,records[e].handler())}},17)}function add(e,t){return idName="HI-"+ ++htivId,records[idName]={start:+new Date,current:0,handler:e,interval:t},isStart||startRun(),idName}function remove(e){delete records[e],hpIsEmptyMap(records)&&stop()}var hpInterval={add:add,remove:remove},main$2=function(r,n,i,e){var a=[0,0,!1],o=[0,0,!1],s=[0,0,!1],c=[0,0,!1],t=hpInterval.add(u,e=e||500);function u(){var e,t;document.body.contains(r)?(e=!1,null!=i&&i.includes("position")&&(t=r.getBoundingClientRect(),s[0]=t.left,s[2]=s[0]!==s[1],c[0]=t.top,c[2]=c[0]!==c[1]),a[0]=r.offsetWidth,a[2]=a[0]!==a[1],o[0]=r.offsetHeight,o[2]=o[0]!==o[1],a[2]&&(a[1]=a[0],null!=i)&&i.includes("width")&&(e=!0),o[2]&&(o[1]=o[0],null!=i)&&i.includes("height")&&(e=!0),(c[2]||s[2])&&(c[1]=c[0],s[1]=s[0],null!=i)&&i.includes("position")&&(e=!0),i&&0!==i.length||(a[2]||o[2]||c[2]||s[2])&&(e=!0),e&&n(r)):l()}function l(){hpInterval.remove(t),a=undefined,o=undefined}return u(),l},freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeGlobal$1=freeGlobal,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal$1||freeSelf||Function("return this")(),root$1=root,Symbol$1=root$1.Symbol,Symbol$2=Symbol$1,objectProto$a=Object.prototype,hasOwnProperty$8=objectProto$a.hasOwnProperty,nativeObjectToString$1=objectProto$a.toString,symToStringTag$1=Symbol$2?Symbol$2.toStringTag:undefined;function getRawTag(e){var t=hasOwnProperty$8.call(e,symToStringTag$1),r=e[symToStringTag$1];try{e[symToStringTag$1]=undefined;var n=!0}catch(a){}var i=nativeObjectToString$1.call(e);return n&&(t?e[symToStringTag$1]=r:delete e[symToStringTag$1]),i}var objectProto$9=Object.prototype,nativeObjectToString=objectProto$9.toString;function objectToString(e){return nativeObjectToString.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag=Symbol$2?Symbol$2.toStringTag:undefined;function baseGetTag(e){return null==e?e===undefined?undefinedTag:nullTag:(symToStringTag&&symToStringTag in Object(e)?getRawTag:objectToString)(e)}function isObjectLike(e){return null!=e&&"object"==typeof e}var symbolTag="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag}var isArray=Array.isArray,isArray$1=isArray,reWhitespace=/\s/;function trimmedEndIndex(e){for(var t=e.length;t--&&reWhitespace.test(e.charAt(t)););return t}var reTrimStart=/^\s+/;function baseTrim(e){return e&&e.slice(0,trimmedEndIndex(e)+1).replace(reTrimStart,"")}function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var NAN=NaN,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if("string"!=typeof(e=isObject(e)?isObject(t="function"==typeof e.valueOf?e.valueOf():e)?t+"":t:e))return 0===e?e:+e;e=baseTrim(e);var t=reIsBinary.test(e);return t||reIsOctal.test(e)?freeParseInt(e.slice(2),t?2:8):reIsBadHex.test(e)?NAN:+e}function identity(e){return e}var asyncTag="[object AsyncFunction]",funcTag$1="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){return!!isObject(e)&&((e=baseGetTag(e))==funcTag$1||e==genTag||e==asyncTag||e==proxyTag)}var coreJsData=root$1["__core-js_shared__"],coreJsData$1=coreJsData,maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData$1&&coreJsData$1.keys&&coreJsData$1.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto$2=Function.prototype,funcToString$2=funcProto$2.toString;function toSource(e){if(null!=e){try{return funcToString$2.call(e)}catch(t){}try{return e+""}catch(t){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$8=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$7=objectProto$8.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$7).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject(e)||isMasked(e))&&(isFunction(e)?reIsNative:reIsHostCtor).test(toSource(e))}function getValue(e,t){return null==e?undefined:e[t]}function getNative(e,t){e=getValue(e,t);return baseIsNative(e)?e:undefined}var objectCreate=Object.create,baseCreate=function(){function t(){}return function(e){if(!isObject(e))return{};if(objectCreate)return objectCreate(e);t.prototype=e;e=new t;return t.prototype=undefined,e}}(),baseCreate$1=baseCreate;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}function copyArray(e,t){var r=-1,n=e.length;for(t=t||Array(n);++r<n;)t[r]=e[r];return t}var HOT_COUNT=800,HOT_SPAN=16,nativeNow=Date.now;function shortOut(r){var n=0,i=0;return function(){var e=nativeNow(),t=HOT_SPAN-(e-i);if(i=e,0<t){if(++n>=HOT_COUNT)return arguments[0]}else n=0;return r.apply(undefined,arguments)}}function constant(e){return function(){return e}}var defineProperty=function(){try{var e=getNative(Object,"defineProperty");return e({},"",{}),e}catch(t){}}(),defineProperty$1=defineProperty,baseSetToString=defineProperty$1?function(e,t){return defineProperty$1(e,"toString",{configurable:!0,enumerable:!1,value:constant(t),writable:!0})}:identity,baseSetToString$1=baseSetToString,setToString=shortOut(baseSetToString),setToString$1=setToString,MAX_SAFE_INTEGER$1=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER$1:t)&&("number"==r||"symbol"!=r&&reIsUint.test(e))&&-1<e&&e%1==0&&e<t}function baseAssignValue(e,t,r){"__proto__"==t&&defineProperty$1?defineProperty$1(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}function eq(e,t){return e===t||e!=e&&t!=t}var objectProto$7=Object.prototype,hasOwnProperty$6=objectProto$7.hasOwnProperty;function assignValue(e,t,r){var n=e[t];hasOwnProperty$6.call(e,t)&&eq(n,r)&&(r!==undefined||t in e)||baseAssignValue(e,t,r)}function copyObject(e,t,r,n){for(var i=!r,a=(r=r||{},-1),o=t.length;++a<o;){var s=t[a],c=n?n(r[s],e[s],s,r,e):undefined;(i?baseAssignValue:assignValue)(r,s,c=c===undefined?e[s]:c)}return r}var nativeMax$1=Math.max;function overRest(a,o,s){return o=nativeMax$1(o===undefined?a.length-1:o,0),function(){for(var e=arguments,t=-1,r=nativeMax$1(e.length-o,0),n=Array(r);++t<r;)n[t]=e[o+t];for(var t=-1,i=Array(o+1);++t<o;)i[t]=e[t];return i[o]=s(n),apply(a,this,i)}}function baseRest(e,t){return setToString$1(overRest(e,t,identity),e+"")}var MAX_SAFE_INTEGER=9007199254740991;function isLength(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=MAX_SAFE_INTEGER}function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}function isIterateeCall(e,t,r){var n;return!!isObject(r)&&!!("number"==(n=typeof t)?isArrayLike(r)&&isIndex(t,r.length):"string"==n&&t in r)&&eq(r[t],e)}function createAssigner(s){return baseRest(function(e,t){var r=-1,n=t.length,i=1<n?t[n-1]:undefined,a=2<n?t[2]:undefined,i=3<s.length&&"function"==typeof i?(n--,i):undefined;for(a&&isIterateeCall(t[0],t[1],a)&&(i=n<3?undefined:i,n=1),e=Object(e);++r<n;){var o=t[r];o&&s(e,o,r,i)}return e})}var objectProto$6=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$6)}function baseTimes(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var argsTag$1="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==argsTag$1}var objectProto$5=Object.prototype,hasOwnProperty$5=objectProto$5.hasOwnProperty,propertyIsEnumerable=objectProto$5.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&hasOwnProperty$5.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")},isArguments$1=isArguments;function stubFalse(){return!1}var freeExports$2="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$2=freeExports$2&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$2=freeModule$2&&freeModule$2.exports===freeExports$2,Buffer$1=moduleExports$2?root$1.Buffer:undefined,nativeIsBuffer=Buffer$1?Buffer$1.isBuffer:undefined,isBuffer=nativeIsBuffer||stubFalse,isBuffer$1=isBuffer,argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag$1="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(t){return function(e){return t(e)}}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag$1]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal$1.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e?e:freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(t){}}(),nodeUtil$1=nodeUtil,nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,isTypedArray$1=isTypedArray,objectProto$4=Object.prototype,hasOwnProperty$4=objectProto$4.hasOwnProperty;function arrayLikeKeys(e,t){var r,n=isArray$1(e),i=!n&&isArguments$1(e),a=!n&&!i&&isBuffer$1(e),o=!n&&!i&&!a&&isTypedArray$1(e),s=n||i||a||o,c=s?baseTimes(e.length,String):[],u=c.length;for(r in e)!t&&!hasOwnProperty$4.call(e,r)||s&&("length"==r||a&&("offset"==r||"parent"==r)||o&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||isIndex(r,u))||c.push(r);return c}function overArg(t,r){return function(e){return t(r(e))}}function nativeKeysIn(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}var objectProto$3=Object.prototype,hasOwnProperty$3=objectProto$3.hasOwnProperty;function baseKeysIn(e){if(!isObject(e))return nativeKeysIn(e);var t,r=isPrototype(e),n=[];for(t in e)("constructor"!=t||!r&&hasOwnProperty$3.call(e,t))&&n.push(t);return n}function keysIn(e){return isArrayLike(e)?arrayLikeKeys(e,!0):baseKeysIn(e)}var nativeCreate=getNative(Object,"create"),nativeCreate$1=nativeCreate;function hashClear(){this.__data__=nativeCreate$1?nativeCreate$1(null):{},this.size=0}function hashDelete(e){e=this.has(e)&&delete this.__data__[e];return this.size-=e?1:0,e}var HASH_UNDEFINED$1="__lodash_hash_undefined__",objectProto$2=Object.prototype,hasOwnProperty$2=objectProto$2.hasOwnProperty;function hashGet(e){var t,r=this.__data__;return nativeCreate$1?(t=r[e])===HASH_UNDEFINED$1?undefined:t:hasOwnProperty$2.call(r,e)?r[e]:undefined}var objectProto$1=Object.prototype,hasOwnProperty$1=objectProto$1.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate$1?t[e]!==undefined:hasOwnProperty$1.call(t,e)}var HASH_UNDEFINED="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=nativeCreate$1&&t===undefined?HASH_UNDEFINED:t,this}function Hash(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,t){for(var r=e.length;r--;)if(eq(e[r][0],t))return r;return-1}Hash.prototype.clear=hashClear,Hash.prototype["delete"]=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,e=assocIndexOf(t,e);return!(e<0||(e==t.length-1?t.pop():splice.call(t,e,1),--this.size,0))}function listCacheGet(e){var t=this.__data__,e=assocIndexOf(t,e);return e<0?undefined:t[e][1]}function listCacheHas(e){return-1<assocIndexOf(this.__data__,e)}function listCacheSet(e,t){var r=this.__data__,n=assocIndexOf(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}function ListCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype["delete"]=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map=getNative(root$1,"Map"),Map$1=Map;function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map$1||ListCache),string:new Hash}}function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData(e,t){e=e.__data__;return isKeyable(t)?e["string"==typeof t?"string":"hash"]:e.map}function mapCacheDelete(e){e=getMapData(this,e)["delete"](e);return this.size-=e?1:0,e}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var r=getMapData(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}function MapCache(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}MapCache.prototype.clear=mapCacheClear,MapCache.prototype["delete"]=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var getPrototype=overArg(Object.getPrototypeOf,Object),getPrototype$1=getPrototype,objectTag="[object Object]",funcProto=Function.prototype,objectProto=Object.prototype,funcToString=funcProto.toString,hasOwnProperty=objectProto.hasOwnProperty,objectCtorString=funcToString.call(Object);function isPlainObject(e){return!(!isObjectLike(e)||baseGetTag(e)!=objectTag)&&(null===(e=getPrototype$1(e))||"function"==typeof(e=hasOwnProperty.call(e,"constructor")&&e.constructor)&&e instanceof e&&funcToString.call(e)==objectCtorString)}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,e=t["delete"](e);return this.size=t.size,e}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}var LARGE_ARRAY_SIZE=200;function stackSet(e,t){var r=this.__data__;if(r instanceof ListCache){var n=r.__data__;if(!Map$1||n.length<LARGE_ARRAY_SIZE-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new MapCache(n)}return r.set(e,t),this.size=r.size,this}function Stack(e){e=this.__data__=new ListCache(e);this.size=e.size}Stack.prototype.clear=stackClear,Stack.prototype["delete"]=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root$1.Buffer:undefined,allocUnsafe=Buffer?Buffer.allocUnsafe:undefined;function cloneBuffer(e,t){return t?e.slice():(t=e.length,t=allocUnsafe?allocUnsafe(t):new e.constructor(t),e.copy(t),t)}var Uint8Array=root$1.Uint8Array,Uint8Array$1=Uint8Array;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);return new Uint8Array$1(t).set(new Uint8Array$1(e)),t}function cloneTypedArray(e,t){t=t?cloneArrayBuffer(e.buffer):e.buffer;return new e.constructor(t,e.byteOffset,e.length)}function initCloneObject(e){return"function"!=typeof e.constructor||isPrototype(e)?{}:baseCreate$1(getPrototype$1(e))}function createBaseFor(c){return function(e,t,r){for(var n=-1,i=Object(e),a=r(e),o=a.length;o--;){var s=a[c?o:++n];if(!1===t(i[s],s,i))break}return e}}var baseFor=createBaseFor(),baseFor$1=baseFor,now=function(){return root$1.Date.now()},now$1=now,FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(n,r,e){var i,a,o,s,c,u,l=0,h=!1,p=!1,t=!0;if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);function f(e){var t=i,r=a;return i=a=undefined,l=e,s=n.apply(r,t)}function d(e){var t=e-u;return u===undefined||r<=t||t<0||p&&o<=e-l}function _(){var e,t=now$1();if(d(t))return g(t);c=setTimeout(_,(e=r-((t=t)-u),p?nativeMin(e,o-(t-l)):e))}function g(e){return c=undefined,t&&i?f(e):(i=a=undefined,s)}function y(){var e=now$1(),t=d(e);if(i=arguments,a=this,u=e,t){if(c===undefined)return l=e=u,c=setTimeout(_,r),h?f(e):s;if(p)return clearTimeout(c),c=setTimeout(_,r),f(u)}return c===undefined&&(c=setTimeout(_,r)),s}return r=toNumber(r)||0,isObject(e)&&(h=!!e.leading,p="maxWait"in e,o=p?nativeMax(toNumber(e.maxWait)||0,r):o,t="trailing"in e?!!e.trailing:t),y.cancel=function(){c!==undefined&&clearTimeout(c),l=0,i=u=a=c=undefined},y.flush=function(){return c===undefined?s:g(now$1())},y}function assignMergeValue(e,t,r){(r===undefined||eq(e[t],r))&&(r!==undefined||t in e)||baseAssignValue(e,t,r)}function isArrayLikeObject(e){return isObjectLike(e)&&isArrayLike(e)}function safeGet(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}function toPlainObject(e){return copyObject(e,keysIn(e))}function baseMergeDeep(e,t,r,n,i,a,o){var s,c,u,l=safeGet(e,r),h=safeGet(t,r),p=o.get(h);p||((t=(p=a?a(l,h,r+"",e,t,o):undefined)===undefined)&&(c=!(s=isArray$1(h))&&isBuffer$1(h),u=!s&&!c&&isTypedArray$1(h),p=h,s||c||u?p=isArray$1(l)?l:isArrayLikeObject(l)?copyArray(l):c?cloneBuffer(h,!(t=!1)):u?cloneTypedArray(h,!(t=!1)):[]:isPlainObject(h)||isArguments$1(h)?isArguments$1(p=l)?p=toPlainObject(l):isObject(l)&&!isFunction(l)||(p=initCloneObject(h)):t=!1),t&&(o.set(h,p),i(p,h,n,a,o),o["delete"](h))),assignMergeValue(e,r,p)}function baseMerge(n,i,a,o,s){n!==i&&baseFor$1(i,function(e,t){var r;s=s||new Stack,isObject(e)?baseMergeDeep(n,i,t,a,baseMerge,o,s):((r=o?o(safeGet(n,t),e,t+"",n,i,s):undefined)===undefined&&(r=e),assignMergeValue(n,t,r))},keysIn)}var mergeWith=createAssigner(function(e,t,r,n){baseMerge(e,t,r,n)}),mergeWith$1=mergeWith;function last(e){var t=null==e?0:e.length;return t?e[t-1]:undefined}function head(e){return e&&e.length?e[0]:undefined}function convertTime(e){e=new Date(e);return{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate(),hour:e.getHours(),minute:e.getMinutes(),second:e.getSeconds(),milliSecond:e.getMilliseconds()}}function findTimeItem(e,t){for(var r,n,i=0;i<e.length;i++){for(var a=0;a<e[i].data.length;a++)if(e[i].data[a].value===t){n=!0,r=e[i].data[a];break}if(n)break}return r}function convertList(e,t){for(var r={},n=0;n<e.length;n++){var i=e[n],a=convertTime(new Date(i).getTime()),o="";"year"===t?o=""+a.year:"month"===t?o=a.year+"-"+a.month:"day"===t?o=a.year+"-"+a.month+"-"+a.day:"hour"===t?o=a.year+"-"+a.month+"-"+a.day+" "+a.hour:"minute"===t&&(o=a.year+"-"+a.month+"-"+a.day+" "+a.hour+":"+a.minute),r[o]||(r[o]={value:i,data:[]}),r[o].data.push({value:i,index:n,scaleLabel:"",tipLabel:""})}var s,c=[];for(s in r)c.push(r[s]);return c.sort(function(e,t){return new Date(e.value).getTime()-new Date(t.value).getTime()}),c}function getDefaultOptions(){return{scale:{type:"day",height:6,lineColor:"#fff",fontColor:"#fff",space:70,bottom:4,font:{size:12,family:"Microsoft YaHei"}},autoplay:{enabled:!1,interval:60},progress:{size:6,padding:1,backgroundActiveColor:"#4492d5",backgroundStaticColor:"#35323f",borderColor:"#000"},label:{}}}var CanvasTimeLineTheme02=function(){function e(e,t){var r=this,t=(this._times=[],this._options=void 0,this._canvas=void 0,this._ctx=void 0,this._element=void 0,this._pressX=0,this._currentWidth=0,this._originTimes=[],this._offsetX={pre:0,current:0},this._currentPopper=void 0,this._previewPopper=void 0,this._playBtn=void 0,this._canvasRoom=void 0,this._bodyContainer=void 0,this._canvasPadding=void 0,this._outerProgress=void 0,this._currentTime=void 0,this._locking=!1,this._timerAuto=void 0,this._timerObv=void 0,this._mousein=!1,this._mouseLeaveDebFunc=void 0,this._canvasHeight=0,this._obvHandler=void 0,this._options=mergeWith$1(getDefaultOptions(),t),e.classList.add("canvas-timeLine-theme02"),this._element=e,this._onMouesmove=this._onMouesmove.bind(this),this._onMouseup=this._onMouseup.bind(this),this._bodyContainer=document.createElement("div"),this._bodyContainer.className="body",this._currentPopper=document.createElement("div"),this._currentPopper.className="current",this._previewPopper=document.createElement("div"),this._previewPopper.className="preview",this._playBtn=document.createElement("div"),this._playBtn.innerText="播放",this._options.autoplay.enabled&&0<this._options.autoplay.interval&&(this._playBtn.innerText="暂停",this._bodyContainer.classList.add("playing")),this._playBtn.className="play",this._canvasRoom=document.createElement("div"),this._canvasRoom.className="canvas-room",this._canvasRoom.style.borderTopWidth=this._options.progress.padding+"px",this._canvasPadding=document.createElement("div"),this._canvasPadding.className="canvas-padding",this._outerProgress=document.createElement("span"),this._outerProgress.className="outer-progress",document.createElement("canvas"));this._canvas=t,this._ctx=t.getContext("2d"),this._canvasHeight=this._options.scale.font.size+this._options.scale.bottom+this._options.scale.height+this._options.progress.padding+this._options.progress.size,e.appendChild(this._bodyContainer),this._bodyContainer.appendChild(this._playBtn),this._canvasRoom.appendChild(t),this._canvasPadding.appendChild(this._canvasRoom),this._canvasPadding.appendChild(this._outerProgress),this._bodyContainer.appendChild(this._canvasPadding),this._bodyContainer.appendChild(this._currentPopper),this._bodyContainer.appendChild(this._previewPopper),this._playBtn.onclick=function(){return r._options.autoplay.enabled?r.stop():r.play(),r},this._obvHandler=main$2(this._element,function(){r._canvas.style.width=r._times.length*r._options.scale.space+"px",clearTimeout(r._timerObv),r._timerObv=setTimeout(function(){r._scrollToCurrent()},30)},["width","position"],100),this._initDrag(),this._updateStyle()}var t=e.prototype;return t._updateStyle=function(){this._canvasPadding.style.padding=[0,this._options.progress.padding+"px"].join(" "),this._outerProgress.style.backgroundColor=this._options.progress.borderColor;var e=2*this._options.progress.padding+this._options.progress.size;this._outerProgress.style.height=e+"px",this._outerProgress.style.borderRadius=Math.ceil(e/2)+"px",this._canvasPadding.style.marginTop=(this._playBtn.offsetHeight-this._options.progress.size-this._options.progress.padding)/2+"px"},t.play=function(){return clearTimeout(this._timerAuto),this._options.autoplay.enabled=!0,this._playBtn.innerHTML="暂停",this._bodyContainer.classList.add("playing"),this._checkAutoPlay(),this},t.stop=function stop(){return clearTimeout(this._timerAuto),this._options.autoplay.enabled=!1,this._playBtn.innerHTML="播放",this._bodyContainer.classList.remove("playing"),this},t._checkAutoPlay=function(){var t=this;clearTimeout(this._timerAuto),this._options.autoplay.enabled&&!this._mousein&&0<this._options.autoplay.interval&&(this._timerAuto=setTimeout(function(){var e=t._findNextTime();t.setDateTime(e,!1)},this._options.autoplay.interval))},t._getPrevTime=function(){for(var e="",t=this._times.length-1;0<=t;t--)for(var r=this._times[t].data.length-1;0<=r;r--)this._times[t].data[r].value===this._currentTime.value&&(e=(0===r?0===t?this._currentTime:last(this._times[t-1].data):this._times[t].data[r-1]).value);return e},t._getNextTime=function(){for(var e="",t=0;t<this._times.length;t++)for(var r=0;r<this._times[t].data.length;r++)this._times[t].data[r].value===this._currentTime.value&&(e=(r===this._times[t].data.length-1?t===this._times.length-1?this._currentTime:this._times[t+1].data[0]:this._times[t].data[r+1]).value);return e},t._findNextTime=function(){for(var e="",t=0;t<this._times.length;t++)for(var r=0;r<this._times[t].data.length;r++)this._times[t].data[r].value===this._currentTime.value&&(e=(r===this._times[t].data.length-1?(t===this._times.length-1?this._times[0]:this._times[t+1]).data[0]:this._times[t].data[r+1]).value);return e},t._onMouseup=function(){this._offsetX.pre=this._offsetX.current,document.removeEventListener("mouseup",this._onMouseup),document.removeEventListener("mousemove",this._onMouesmove)},t._onMouesmove=function(e){var e=e.clientX-this._pressX,t=e+this._offsetX.pre+this._minLeftSpace;e<0?(e=Math.max(t,-(this._getMaxWidth()-this._canvasRoom.offsetWidth)),this._offsetX.current=Math.min(e,0)):this._offsetX.current=Math.min(t,0),this.draw()},t._initDrag=function(){var i=this;this._canvas.onmousedown=function(e){i._mousein=!0,i._pressX=e.clientX+i._minLeftSpace,document.removeEventListener("mouseup",i._onMouseup),document.removeEventListener("mousemove",i._onMouesmove),document.addEventListener("mouseup",i._onMouseup),document.addEventListener("mousemove",i._onMouesmove)},this._canvas.onmousemove=function(e){i._mousein=!0;var t,r,n,e=i._getMouseDatetime(e.clientX,i._currentWidth);e?(t=i._offsetX.current+i._getTimeTickWidth(e.value),e.tipLabel||(e.tipLabel=null!=(r=null==(n=(r=i._options.label).formatter)?void 0:n.call(r,e.value,e.index))?r:e.value),console.log("currentScale",t),i._previewPopper.innerText=e.tipLabel,i._previewPopper.style.display="block",n=i._canvas.getBoundingClientRect(),i._previewPopper.style.left=n.left+t-i._previewPopper.offsetWidth/2+"px",i._previewPopper.style.top=n.top-i._previewPopper.offsetHeight-8+"px"):i._previewPopper.style.display="none"},this._mouseLeaveDebFunc=debounce(function(){i._previewPopper.style.display="none",i._mousein=!1,i._checkAutoPlay()},200),this._canvas.onmouseout=this._canvas.onmouseleave=this._mouseLeaveDebFunc,this._canvas.ondblclick=function(e){e=i._getMouseDatetime(e.clientX,i._currentWidth);e&&i.setDateTime(e.value,!0)}},t._getTimeTickWidth=function(e){for(var t=0,r=!1,n=0;n<this._times.length;n++){for(var i=0;i<this._times[n].data.length;i++)if(this._times[n].data[i].value===e){var a=this._times[n].data.length;n===this._times.length-1&&(a=Math.max(a-1,1)),t=n*this._options.scale.space+this._options.scale.space/a*i,r=!0;break}if(r)break}return t},t.setData=function(e){return this._currentTime=undefined,(e=cloneEasy(e)).sort(function(e,t){return new Date(e).getTime()-new Date(t).getTime()}),this._originTimes=e,this._times=convertList(e,this._options.scale.type),e.length?(this._canvas.style.width=this._times.length*this._options.scale.space+"px",this.setDateTime(head(e),!1)):this.clear(),this},t.draw=function(){clearTimeout(this._timerObv),null!=(e=this._options)&&null!=(t=e.beforeDraw)&&t.call(e);var e=this._getMaxWidth(),t=this._canvasRoom.offsetWidth;this._canvasRoom.offsetWidth>e&&(t=e,this._offsetX.current=0,this._offsetX.pre=0),this._canvas.width=t,this._canvas.height=this._canvasHeight,this._canvas.style.width=t+"px",this._canvas.style.height=this._canvasHeight+"px",this._canvasRoom.style.height=this._canvasHeight+"px",this._ctx.fillStyle="transparent",this._ctx.fillRect(0,0,t,this._canvasHeight),this._drawScales(),this._drawProgress()},t._formatScale=function(e){var t;return this._options.scale.formatter?this._options.scale.formatter(e.value,e.index):(t=convertTime(new Date(e.value).getTime()),"year"===this._options.scale.type?padStart(t.year,4,"0")+"年":"month"===this._options.scale.type?padStart(t.year,4,"0")+"年"+padStart(t.month,2,"0")+"月":"day"===this._options.scale.type?padStart(t.month,2,"0")+"月"+padStart(t.day,2,"0")+"日":"hour"===this._options.scale.type?padStart(t.day,2,"0")+"日"+padStart(t.hour,2,"0")+"时":"minute"===this._options.scale.type?padStart(t.hour,2,"0")+"时"+padStart(t.minute,2,"0")+"分":e.value)},t._getMouseDatetime=function(e,t){var r,n=this._canvas.getBoundingClientRect(),e=Math.round(e-n.left),n=(e-=this._offsetX.current,Math.floor(e/this._options.scale.space)),i=this._times[n];if(i)return r=0,e<t?r=Math.floor(e%this._options.scale.space/(this._options.scale.space/i.data.length)):(r=Math.ceil(e%this._options.scale.space/(this._options.scale.space/i.data.length)))>i.data.length-1&&(r=0,i=this._times[++n]),null!=(t=i)&&null!=(e=t.data)&&e[r]||(n=this._times.length-1,r=(i=this._times[n]).data.length-1),i.data[r]},t._getMaxWidth=function(){var e,t=this._times.length*this._options.scale.space;return 1===(null==(e=last(this._times))?void 0:e.data.length)&&(t-=this._options.scale.space),t},t._drawProgress=function(){var e,t,r,n;this._currentTime&&(this._currentWidth=this._currentWidth,t=this._options.progress.size/2,this._ctx.beginPath(),this._ctx.lineWidth=this._options.progress.size,this._ctx.lineCap="round",this._ctx.strokeStyle=this._options.progress.backgroundStaticColor,this._ctx.moveTo(t,t),this._ctx.lineTo(this._canvas.offsetWidth-t,t),this._ctx.stroke(),this._ctx.closePath(),0<=(r=e=this._currentWidth+this._offsetX.current)&&(r-=(n=Math.max(this._options.progress.size,2))/2,r=Math.min(this._canvas.offsetWidth-t,r),r=Math.max(r,t),this._ctx.beginPath(),this._ctx.lineWidth=n,this._ctx.strokeStyle=this._options.progress.backgroundActiveColor,this._ctx.moveTo(t,t),this._ctx.lineTo(r,t),this._ctx.stroke(),this._ctx.closePath()),this._currentTime&&e<=this._canvasRoom.offsetWidth&&0<=e?(this._currentPopper.style.display="block",this._currentTime.tipLabel||(this._currentTime.tipLabel=null!=(t=null==(r=(n=this._options.label).formatter)?void 0:r.call(n,this._currentTime.value,this._currentTime.index))?t:this._currentTime.value),this._currentPopper.innerText=this._currentTime.tipLabel,n=this._canvas.getBoundingClientRect(),this._currentPopper.style.left=n.left+e-this._currentPopper.offsetWidth/2+"px",this._currentPopper.style.top=n.top-this._currentPopper.offsetHeight-8+"px"):this._currentPopper.style.display="none")},t._drawScales=function(){this._ctx.lineCap="butt",this._ctx.textBaseline="ideographic",this._ctx.fillStyle=this._options.scale.fontColor,this._ctx.font=this._options.scale.font.size+"px "+this._options.scale.font.family,this._ctx.lineWidth=1,this._ctx.strokeStyle=this._options.scale.lineColor,this._ctx.beginPath();for(var e,t,r,n=0;n<this._times.length;n++)n===this._times.length-1&&1===(null==(e=last(this._times))?void 0:e.data.length)||(e=this._times[n].data[0],t=this._options.scale.space*n-.5+this._offsetX.current,this._ctx.moveTo(t,0+this._options.progress.size+this._options.progress.padding),this._ctx.lineTo(t,this._options.scale.height+this._options.progress.size+this._options.progress.padding),this._ctx.stroke(),e.scaleLabel||(e.scaleLabel=this._formatScale(e)),r=this._ctx.measureText(e.scaleLabel).width,this._ctx.fillText(e.scaleLabel,t-Math.floor(r/2),this._canvasHeight));this._ctx.closePath()},t._scrollToCurrent=function(){this._currentTime&&(this._pressX=0,this._offsetX.pre=0,this._offsetX.current=this._offsetX.pre,this._onMouesmove({clientX:-this._currentWidth}),this._offsetX.pre=this._offsetX.current)},t.setDateTime=function(t,e){var r,n=this;if(clearTimeout(this._timerAuto),(null==(r=this._currentTime)?void 0:r.value)!==t)return this._locking?console.error('时间设置失败： "'+t+'"。上一个切换未完成！'):this._originTimes.some(function(e){return e===t})?(this._currentTime=findTimeItem(this._times,t),this._currentTime?(this._currentWidth=this._getTimeTickWidth(this._currentTime.value),e?this.draw():this._scrollToCurrent(),null!=(r=this._options)&&r.onChange&&(this._locking=!0,e={value:this._currentTime.value,start:head(this._originTimes),end:last(this._originTimes),prev:this._getPrevTime(),next:this._getNextTime()},this._options.onChange(e,function(){n._locking=!1,n._checkAutoPlay()}))):this.clear()):console.error('时间设置失败： "'+t+'" 不在列表中'),this},t.clear=function(){clearTimeout(this._timerObv),clearTimeout(this._timerAuto),this._mousein=!1,this._locking=!1,this._originTimes=[],this._currentWidth=0,this._pressX=0,this._ctx.clearRect(0,0,this._canvasRoom.offsetWidth,this._canvasHeight),this._currentPopper.style.display="none",this._previewPopper.style.display="none",this._canvas.style.width="0px",this._currentTime=undefined,document.removeEventListener("mouseup",this._onMouseup),document.removeEventListener("mousemove",this._onMouesmove)},t.dispose=function(){var e;this.stop(),null!=(e=this._mouseLeaveDebFunc)&&e.cancel(),this._obvHandler(),this.clear()},_createClass(e,[{key:"_minLeftSpace",get:function(){var e;return null!=(e=this._options.label.leftSpace)?e:Math.floor(this._canvas.offsetWidth/2)}}]),e}();export{CanvasTimeLineTheme02 as default};
