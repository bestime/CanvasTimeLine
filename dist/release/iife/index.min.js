/**  
 * CanvasTimeLineTheme02.iife.min.js
 * @QQ 1174295440
 * @update 2023-04-03 10:12:20
 */
var CanvasTimeLineTheme02=function(){"use strict";function D(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,function(t){t=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(n===undefined)return("string"===e?String:Number)(t);t=n.call(t,e||"default");if("object"!=typeof t)return t;throw new TypeError("@@toPrimitive must return a primitive value.")}(t,"string");return"symbol"==typeof t?t:String(t)}(i.key),i)}}function E(t){return null===(e=t)||e===undefined?"":String(t);var e}var R=Object.prototype.toString;function s(t){switch(R.call(t).slice(8,-1)){case"Array":for(var e=[],n=0;n<t.length;n++)e.push(s(t[n]));break;case"Object":for(var i in e={},t)e[i]=s(t[i]);break;case"Function":function r(){t.apply(this,arguments)}for(var o in t.prototype)r.prototype[o]=t.prototype[o];e=r;break;default:e=t}return e}function B(t,e,n,i){return(t=E(t)).length>(e>>=0)?t:(e-=t.length,n.length<e&&(n+=function(t,e){var n="";if((t=E(t)).length*e<1<<28)for(;1==(1&e)&&(n+=t),0!=(e>>>=1);)t+=t;return n}(n,e/n.length)),-1===i?n.slice(0,e)+t:t+n.slice(0,e))}function r(t,e,n){return B(t,e,n,-1)}document.getElementsByTagName("head")[0];var n,i,H=0,o=!1,a={};function N(){o=!1,clearInterval(n),n=undefined}var F={add:function(t,e){return i="HI-"+ ++H,a[i]={start:+new Date,current:0,handler:t,interval:e},o||(clearInterval(n),o=!0,n=setInterval(function(){for(var t in a){var e=a[t];e.current=+new Date,e.current-e.start>=e.interval&&(e.start=e.current,a[t].handler())}},17)),i},remove:function(t){delete a[t],function(t){var e,n=!0;for(e in t)if(e!==undefined){n=!1;break}return n}(a)&&N()}},t="object"==typeof global&&global&&global.Object===Object&&global,e="object"==typeof self&&self&&self.Object===Object&&self,u=t||e||Function("return this")(),e=u.Symbol,c=Object.prototype,I=c.hasOwnProperty,$=c.toString,h=e?e.toStringTag:undefined;var U=Object.prototype.toString;var q="[object Null]",Y="[object Undefined]",G=e?e.toStringTag:undefined;function _(t){if(null==t)return t===undefined?Y:q;if(G&&G in Object(t)){var e=t,n=I.call(e,h),i=e[h];try{e[h]=undefined;var r=!0}catch(s){}var o=$.call(e);return r&&(n?e[h]=i:delete e[h]),o}return U.call(t)}function f(t){return null!=t&&"object"==typeof t}var V="[object Symbol]";var d=Array.isArray,J=/\s/;var K=/^\s+/;function Q(t){return t&&t.slice(0,function(t){for(var e=t.length;e--&&J.test(t.charAt(e)););return e}(t)+1).replace(K,"")}function y(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}var Z=NaN,tt=/^[-+]0x[0-9a-f]+$/i,et=/^0b[01]+$/i,nt=/^0o[0-7]+$/i,it=parseInt;function rt(t){if("number"==typeof t)return t;if("symbol"==typeof(e=t)||f(e)&&_(e)==V)return Z;if("string"!=typeof(t=y(t)?y(e="function"==typeof t.valueOf?t.valueOf():t)?e+"":e:t))return 0===t?t:+t;t=Q(t);var e=et.test(t);return e||nt.test(t)?it(t.slice(2),e?2:8):tt.test(t)?Z:+t}function ot(t){return t}var st="[object AsyncFunction]",at="[object Function]",ut="[object GeneratorFunction]",ct="[object Proxy]";function v(t){if(y(t))return(t=_(t))==at||t==ut||t==st||t==ct}var c=u["__core-js_shared__"],ht=(e=/[^.]+$/.exec(c&&c.keys&&c.keys.IE_PROTO||""))?"Symbol(src)_1."+e:"";var lt=Function.prototype.toString;var pt=/^\[object .+?Constructor\]$/,c=Function.prototype,e=Object.prototype,c=c.toString,e=e.hasOwnProperty,_t=RegExp("^"+c.call(e).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function ft(t){var e;return y(t)&&(e=t,!(ht&&ht in e))&&(v(t)?_t:pt).test(function(t){if(null!=t){try{return lt.call(t)}catch(e){}try{return t+""}catch(e){}}return""}(t))}function l(t,e){e=e;e=null==(t=t)?undefined:t[e];return ft(e)?e:undefined}var dt=Object.create;function p(){}var vt=function(t){if(!y(t))return{};if(dt)return dt(t);p.prototype=t;t=new p;return p.prototype=undefined,t};var mt=Date.now;var m=function(){try{var t=l(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();yt=m?function(t,e){return m(t,"toString",{configurable:!0,enumerable:!1,value:(n=e,function(){return n}),writable:!0});var n}:ot,b=g=0;var yt,g,b,e=function(){var t=mt(),e=16-(t-b);if(b=t,0<e){if(800<=++g)return arguments[0]}else g=0;return yt.apply(undefined,arguments)},gt=9007199254740991,bt=/^(?:0|[1-9]\d*)$/;function Tt(t,e){var n=typeof t;return(e=null==e?gt:e)&&("number"==n||"symbol"!=n&&bt.test(t))&&-1<t&&t%1==0&&t<e}function T(t,e,n){"__proto__"==e&&m?m(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function x(t,e){return t===e||t!=t&&e!=e}var xt=Object.prototype.hasOwnProperty;function jt(t,e,n,i){for(var r,o,s=!n,a=(n=n||{},-1),u=e.length;++a<u;){var c=e[a],h=i?i(n[c],t[c],c,n,t):undefined;h===undefined&&(h=t[c]),s?T(n,c,h):(h=h,o=void 0,o=(r=n)[c=c],xt.call(r,c)&&x(o,h)&&(h!==undefined||c in r)||T(r,c,h))}return n}var wt=Math.max;function Pt(u,c,h){return c=wt(c===undefined?u.length-1:c,0),function(){for(var t=arguments,e=-1,n=wt(t.length-c,0),i=Array(n);++e<n;)i[e]=t[c+e];for(var e=-1,r=Array(c+1);++e<c;)r[e]=t[e];r[c]=h(i);var o=u,s=this,a=r;switch(a.length){case 0:return o.call(s);case 1:return o.call(s,a[0]);case 2:return o.call(s,a[0],a[1]);case 3:return o.call(s,a[0],a[1],a[2])}return o.apply(s,a)}}var Ot=9007199254740991;function Mt(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=Ot}function j(t){return null!=t&&Mt(t.length)&&!v(t)}var Ct=Object.prototype;function kt(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||Ct)}function At(t){return f(t)&&"[object Arguments]"==_(t)}var c=Object.prototype,St=c.hasOwnProperty,Lt=c.propertyIsEnumerable,w=At(function(){return arguments}())?At:function(t){return f(t)&&St.call(t,"callee")&&!Lt.call(t,"callee")};var c="object"==typeof exports&&exports&&!exports.nodeType&&exports,P=c&&"object"==typeof module&&module&&!module.nodeType&&module,P=P&&P.exports===c?u.Buffer:undefined,Wt=(P?P.isBuffer:undefined)||function(){return!1},O={};O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Arguments]"]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object Boolean]"]=O["[object DataView]"]=O["[object Date]"]=O["[object Error]"]=O["[object Function]"]=O["[object Map]"]=O["[object Number]"]=O["[object Object]"]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object WeakMap]"]=!1;var zt,c="object"==typeof exports&&exports&&!exports.nodeType&&exports,M=c&&"object"==typeof module&&module&&!module.nodeType&&module,Xt=M&&M.exports===c&&t.process,P=function(){try{var t=M&&M.require&&M.require("util").types;return t?t:Xt&&Xt.binding&&Xt.binding("util")}catch(e){}}(),c=P&&P.isTypedArray,Dt=c?(zt=c,function(t){return zt(t)}):function(t){return f(t)&&Mt(t.length)&&!!O[_(t)]},Et=Object.prototype.hasOwnProperty;function Rt(t,e){var n,i=d(t),r=!i&&w(t),o=!i&&!r&&Wt(t),s=!i&&!r&&!o&&Dt(t),a=i||r||o||s,u=a?function(t,e){for(var n=-1,i=Array(t);++n<t;)i[n]=e(n);return i}(t.length,String):[],c=u.length;for(n in t)!e&&!Et.call(t,n)||a&&("length"==n||o&&("offset"==n||"parent"==n)||s&&("buffer"==n||"byteLength"==n||"byteOffset"==n)||Tt(n,c))||u.push(n);return u}var Bt=Object.prototype.hasOwnProperty;function Ht(t){if(!y(t)){var e=t,n=[];if(null!=e)for(var i in Object(e))n.push(i);return n}var r,o=kt(t),s=[];for(r in t)("constructor"!=r||!o&&Bt.call(t,r))&&s.push(r);return s}function Nt(t){return j(t)?Rt(t,!0):Ht(t)}var C=l(Object,"create");var Ft=Object.prototype.hasOwnProperty;var It=Object.prototype.hasOwnProperty;function k(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}function A(t,e){for(var n=t.length;n--;)if(x(t[n][0],e))return n;return-1}k.prototype.clear=function(){this.__data__=C?C(null):{},this.size=0},k.prototype["delete"]=function(t){return t=this.has(t)&&delete this.__data__[t],this.size-=t?1:0,t},k.prototype.get=function(t){var e,n=this.__data__;return C?"__lodash_hash_undefined__"===(e=n[t])?undefined:e:Ft.call(n,t)?n[t]:undefined},k.prototype.has=function(t){var e=this.__data__;return C?e[t]!==undefined:It.call(e,t)},k.prototype.set=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=C&&e===undefined?"__lodash_hash_undefined__":e,this};var $t=Array.prototype.splice;function S(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}S.prototype.clear=function(){this.__data__=[],this.size=0},S.prototype["delete"]=function(t){var e=this.__data__;return!((t=A(e,t))<0||(t==e.length-1?e.pop():$t.call(e,t,1),--this.size,0))},S.prototype.get=function(t){var e=this.__data__;return(t=A(e,t))<0?undefined:e[t][1]},S.prototype.has=function(t){return-1<A(this.__data__,t)},S.prototype.set=function(t,e){var n=this.__data__,i=A(n,t);return i<0?(++this.size,n.push([t,e])):n[i][1]=e,this};var Ut=l(u,"Map");function L(t,e){var n,i,t=t.__data__;return("string"==(i=typeof(n=e))||"number"==i||"symbol"==i||"boolean"==i?"__proto__"!==n:null===n)?t["string"==typeof e?"string":"hash"]:t.map}function W(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var i=t[e];this.set(i[0],i[1])}}W.prototype.clear=function(){this.size=0,this.__data__={hash:new k,map:new(Ut||S),string:new k}},W.prototype["delete"]=function(t){return t=L(this,t)["delete"](t),this.size-=t?1:0,t},W.prototype.get=function(t){return L(this,t).get(t)},W.prototype.has=function(t){return L(this,t).has(t)},W.prototype.set=function(t,e){var n=L(this,t),i=n.size;return n.set(t,e),this.size+=n.size==i?0:1,this},qt=Object.getPrototypeOf,Yt=Object;var qt,Yt,Gt=function(t){return qt(Yt(t))},Vt="[object Object]",t=Function.prototype,P=Object.prototype,Jt=t.toString,Kt=P.hasOwnProperty,Qt=Jt.call(Object);function z(t){t=this.__data__=new S(t);this.size=t.size}z.prototype.clear=function(){this.__data__=new S,this.size=0},z.prototype["delete"]=function(t){var e=this.__data__,t=e["delete"](t);return this.size=e.size,t},z.prototype.get=function(t){return this.__data__.get(t)},z.prototype.has=function(t){return this.__data__.has(t)},z.prototype.set=function(t,e){var n=this.__data__;if(n instanceof S){var i=n.__data__;if(!Ut||i.length<199)return i.push([t,e]),this.size=++n.size,this;n=this.__data__=new W(i)}return n.set(t,e),this.size=n.size,this};var c="object"==typeof exports&&exports&&!exports.nodeType&&exports,t=c&&"object"==typeof module&&module&&!module.nodeType&&module,P=t&&t.exports===c?u.Buffer:undefined,Zt=P?P.allocUnsafe:undefined;var te=u.Uint8Array;function ee(t,e){var n,e=e?(e=t.buffer,n=new e.constructor(e.byteLength),new te(n).set(new te(e)),n):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}var ne,ie=function(t,e,n){for(var i=-1,r=Object(t),o=n(t),s=o.length;s--;){var a=o[ne?s:++i];if(!1===e(r[a],a,r))break}return t},re=function(){return u.Date.now()},oe=Math.max,se=Math.min;function ae(i,n,t){var r,o,s,a,u,c,h=0,l=!1,p=!1,e=!0;if("function"!=typeof i)throw new TypeError("Expected a function");function _(t){var e=r,n=o;return r=o=undefined,h=t,a=i.apply(n,e)}function f(t){var e=t-c;return c===undefined||n<=e||e<0||p&&s<=t-h}function d(){var t,e=re();if(f(e))return v(e);u=setTimeout(d,(t=n-((e=e)-c),p?se(t,s-(e-h)):t))}function v(t){return u=undefined,e&&r?_(t):(r=o=undefined,a)}function m(){var t=re(),e=f(t);if(r=arguments,o=this,c=t,e){if(u===undefined)return h=t=c,u=setTimeout(d,n),l?_(t):a;if(p)return clearTimeout(u),u=setTimeout(d,n),_(c)}return u===undefined&&(u=setTimeout(d,n)),a}return n=rt(n)||0,y(t)&&(l=!!t.leading,p="maxWait"in t,s=p?oe(rt(t.maxWait)||0,n):s,e="trailing"in t?!!t.trailing:e),m.cancel=function(){u!==undefined&&clearTimeout(u),h=0,r=c=o=u=undefined},m.flush=function(){return u===undefined?a:v(re())},m}function ue(t,e,n){(n===undefined||x(t[e],n))&&(n!==undefined||e in t)||T(t,e,n)}function ce(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}function he(t,e,n,i,r,o,s){var a,u,c,h=ce(t,n),l=ce(e,n),p=s.get(l);p||((e=(p=o?o(h,l,n+"",t,e,s):undefined)===undefined)&&(u=!(c=d(l))&&Wt(l),a=!c&&!u&&Dt(l),p=l,c||u||a?p=d(h)?h:f(c=h)&&j(c)?function(t,e){var n=-1,i=t.length;for(e=e||Array(i);++n<i;)e[n]=t[n];return e}(h):u?(c=l,(u=!(e=!1))?c.slice():(u=c.length,u=Zt?Zt(u):new c.constructor(u),c.copy(u),u)):a?ee(l,!(e=!1)):[]:function(t){if(f(t)&&_(t)==Vt)return null===(t=Gt(t))||"function"==typeof(t=Kt.call(t,"constructor")&&t.constructor)&&t instanceof t&&Jt.call(t)==Qt}(l)||w(l)?w(p=h)?p=jt(h,Nt(h)):y(h)&&!v(h)||(p="function"!=typeof(c=l).constructor||kt(c)?{}:vt(Gt(c))):e=!1),e&&(s.set(l,p),r(p,l,i,o,s),s["delete"](l))),ue(t,n,p)}function le(i,r,o,s,a){i!==r&&ie(r,function(t,e){var n;a=a||new z,y(t)?he(i,r,e,o,le,s,a):((n=s?s(ce(i,e),t,e+"",i,r,a):undefined)===undefined&&(n=t),ue(i,e,n))},Nt)}pe=function(t,e,n,i){le(t,e,n,i)};var pe,_e,fe=e(Pt(t=function(t,e){var n=-1,i=e.length,r=1<i?e[i-1]:undefined,o=2<i?e[2]:undefined,r=3<pe.length&&"function"==typeof r?(i--,r):undefined;for(o&&function(t,e,n){var i;if(y(n))return("number"==(i=typeof e)?j(n)&&Tt(e,n.length):"string"==i&&e in n)&&x(n[e],t)}(e[0],e[1],o)&&(r=i<3?undefined:r,i=1),t=Object(t);++n<i;){var s=e[n];s&&pe(t,s,n,r)}return t},_e,ot),t+"");function X(t){var e=null==t?0:t.length;return e?t[e-1]:undefined}function de(t){return t&&t.length?t[0]:undefined}function ve(t){t=new Date(t);return{year:t.getFullYear(),month:t.getMonth()+1,day:t.getDate(),hour:t.getHours(),minute:t.getMinutes(),second:t.getSeconds(),milliSecond:t.getMilliseconds()}}return function(){function t(t,e){var n,i,r,o,s,a,u,c,h=this,e=(this._times=[],this._options=void 0,this._canvas=void 0,this._ctx=void 0,this._element=void 0,this._pressX=0,this._currentWidth=0,this._originTimes=[],this._offsetX={pre:0,current:0},this._currentPopper=void 0,this._previewPopper=void 0,this._playBtn=void 0,this._canvasRoom=void 0,this._bodyContainer=void 0,this._canvasPadding=void 0,this._outerProgress=void 0,this._currentTime=void 0,this._locking=!1,this._timerAuto=void 0,this._timerObv=void 0,this._mousein=!1,this._mouseLeaveDebFunc=void 0,this._canvasHeight=0,this._obvHandler=void 0,this._options=fe({scale:{type:"day",height:6,lineColor:"#fff",fontColor:"#fff",space:70,bottom:4,font:{size:12,family:"Microsoft YaHei"}},autoplay:{enabled:!1,interval:60},progress:{size:6,padding:1,backgroundActiveColor:"#4492d5",backgroundStaticColor:"#35323f",borderColor:"#000"},label:{}},e),t.classList.add("canvas-timeLine-theme02"),this._element=t,this._onMouesmove=this._onMouesmove.bind(this),this._onMouseup=this._onMouseup.bind(this),this._bodyContainer=document.createElement("div"),this._bodyContainer.className="body",this._currentPopper=document.createElement("div"),this._currentPopper.className="current",this._previewPopper=document.createElement("div"),this._previewPopper.className="preview",this._playBtn=document.createElement("div"),this._playBtn.innerText="播放",this._options.autoplay.enabled&&0<this._options.autoplay.interval&&(this._playBtn.innerText="暂停",this._bodyContainer.classList.add("playing")),this._playBtn.className="play",this._canvasRoom=document.createElement("div"),this._canvasRoom.className="canvas-room",this._canvasPadding=document.createElement("div"),this._canvasPadding.className="canvas-padding",this._outerProgress=document.createElement("span"),this._outerProgress.className="outer-progress",document.createElement("canvas"));function l(){var t,e;document.body.contains(n)?(t=!1,null!=r&&r.includes("position")&&(e=n.getBoundingClientRect(),a[0]=e.left,a[2]=a[0]!==a[1],u[0]=e.top,u[2]=u[0]!==u[1]),o[0]=n.offsetWidth,o[2]=o[0]!==o[1],s[0]=n.offsetHeight,s[2]=s[0]!==s[1],o[2]&&(o[1]=o[0],null!=r)&&r.includes("width")&&(t=!0),s[2]&&(s[1]=s[0],null!=r)&&r.includes("height")&&(t=!0),(u[2]||a[2])&&(u[1]=u[0],a[1]=a[0],null!=r)&&r.includes("position")&&(t=!0),r&&0!==r.length||(o[2]||s[2]||u[2]||a[2])&&(t=!0),t&&i(n)):p()}function p(){F.remove(c),o=undefined,s=undefined}this._canvas=e,this._ctx=e.getContext("2d"),this._canvasHeight=this._options.scale.font.size+this._options.scale.bottom+this._options.scale.height+this._options.progress.padding+this._options.progress.size,t.appendChild(this._bodyContainer),this._bodyContainer.appendChild(this._playBtn),this._canvasRoom.appendChild(e),this._canvasPadding.appendChild(this._canvasRoom),this._canvasPadding.appendChild(this._outerProgress),this._bodyContainer.appendChild(this._canvasPadding),this._bodyContainer.appendChild(this._currentPopper),this._bodyContainer.appendChild(this._previewPopper),this._playBtn.onclick=function(){return h._options.autoplay.enabled?h.stop():h.play(),h},this._obvHandler=(n=this._element,i=function(){h._canvas.style.width=h._times.length*h._options.scale.space+"px",clearTimeout(h._timerObv),h._timerObv=setTimeout(function(){h._scrollToCurrent()},30)},r=["width","position"],u=[0,0,!(a=[0,0,!(s=[0,0,!(o=[0,0,!(t=100)])])])],c=F.add(l,t=t||500),l(),p),this._initDrag(),this._updateStyle()}var e,n,i=t.prototype;return i._updateStyle=function(){this._canvasRoom.style.borderTopWidth=this._options.progress.padding+"px",this._canvasPadding.style.padding=[0,this._options.progress.padding+"px"].join(" "),this._outerProgress.style.backgroundColor=this._options.progress.borderColor;var t=2*this._options.progress.padding+this._options.progress.size,t=(this._outerProgress.style.height=t+"px",this._outerProgress.style.borderRadius=Math.ceil(t/2)+"px",(this._playBtn.offsetHeight-this._options.progress.size-2*this._options.progress.padding)/2);0<t?(this._canvasPadding.style.marginTop=t+"px",this._playBtn.style.marginTop="0px"):(this._canvasPadding.style.marginTop="0px",this._playBtn.style.marginTop=-t+"px")},i.play=function(){return clearTimeout(this._timerAuto),this._options.autoplay.enabled=!0,this._playBtn.innerHTML="暂停",this._bodyContainer.classList.add("playing"),this._checkAutoPlay(),this},i.stop=function N(){return clearTimeout(this._timerAuto),this._options.autoplay.enabled=!1,this._playBtn.innerHTML="播放",this._bodyContainer.classList.remove("playing"),this},i._checkAutoPlay=function(){var e=this;clearTimeout(this._timerAuto),this._options.autoplay.enabled&&!this._mousein&&0<this._options.autoplay.interval&&(this._timerAuto=setTimeout(function(){var t=e._findNextTime();e.setDateTime(t,!1)},this._options.autoplay.interval))},i._getPrevTime=function(){for(var t="",e=this._times.length-1;0<=e;e--)for(var n=this._times[e].data.length-1;0<=n;n--)this._times[e].data[n].value===this._currentTime.value&&(t=(0===n?0===e?this._currentTime:X(this._times[e-1].data):this._times[e].data[n-1]).value);return t},i._getNextTime=function(){for(var t="",e=0;e<this._times.length;e++)for(var n=0;n<this._times[e].data.length;n++)this._times[e].data[n].value===this._currentTime.value&&(t=(n===this._times[e].data.length-1?e===this._times.length-1?this._currentTime:this._times[e+1].data[0]:this._times[e].data[n+1]).value);return t},i._findNextTime=function(){for(var t="",e=0;e<this._times.length;e++)for(var n=0;n<this._times[e].data.length;n++)this._times[e].data[n].value===this._currentTime.value&&(t=(n===this._times[e].data.length-1?(e===this._times.length-1?this._times[0]:this._times[e+1]).data[0]:this._times[e].data[n+1]).value);return t},i._onMouseup=function(){this._offsetX.pre=this._offsetX.current,document.removeEventListener("mouseup",this._onMouseup),document.removeEventListener("mousemove",this._onMouesmove)},i._onMouesmove=function(t){var t=t.clientX-this._pressX,e=t+this._offsetX.pre+this._minLeftSpace;t<0?(t=Math.max(e,-(this._getMaxWidth()-this._canvasRoom.offsetWidth)),this._offsetX.current=Math.min(t,0)):this._offsetX.current=Math.min(e,0),this.draw()},i._initDrag=function(){var r=this;this._canvas.onmousedown=function(t){r._mousein=!0,r._pressX=t.clientX+r._minLeftSpace,document.removeEventListener("mouseup",r._onMouseup),document.removeEventListener("mousemove",r._onMouesmove),document.addEventListener("mouseup",r._onMouseup),document.addEventListener("mousemove",r._onMouesmove)},this._canvas.onmousemove=function(t){r._mousein=!0;var e,n,i,t=r._getMouseDatetime(t.clientX,r._currentWidth);t?(n=(e=r._offsetX.current+r._getTimeTickWidth(t.value))-r._canvasRoom.offsetWidth,e<0?e=0:0<n&&(e-=n),t.tipLabel||(t.tipLabel=null!=(n=null==(i=(n=r._options.label).formatter)?void 0:i.call(n,t.value,t.index))?n:t.value),r._previewPopper.innerText=t.tipLabel,r._previewPopper.style.display="block",i=r._canvas.getBoundingClientRect(),r._previewPopper.style.left=i.left+e-r._previewPopper.offsetWidth/2+"px",r._previewPopper.style.top=i.top-r._previewPopper.offsetHeight-8+"px"):r._previewPopper.style.display="none"},this._mouseLeaveDebFunc=ae(function(){r._previewPopper.style.display="none",r._mousein=!1,r._checkAutoPlay()},500),this._canvas.onmouseout=this._canvas.onmouseleave=this._mouseLeaveDebFunc,this._canvas.ondblclick=function(t){t=r._getMouseDatetime(t.clientX,r._currentWidth);t&&r.setDateTime(t.value,!0)}},i._getTimeTickWidth=function(t){for(var e=0,n=!1,i=0;i<this._times.length;i++){for(var r=0;r<this._times[i].data.length;r++)if(this._times[i].data[r].value===t){var o=this._times[i].data.length;i===this._times.length-1&&(o=Math.max(o-1,1)),e=i*this._options.scale.space+this._options.scale.space/o*r,n=!0;break}if(n)break}return e},i.setData=function(t){return this._currentTime=undefined,(t=s(t)).sort(function(t,e){return new Date(t).getTime()-new Date(e).getTime()}),this._originTimes=t,this._times=function(t,e){for(var n={},i=0;i<t.length;i++){var r=t[i],o=ve(new Date(r).getTime()),s="";"year"===e?s=""+o.year:"month"===e?s=o.year+"-"+o.month:"day"===e?s=o.year+"-"+o.month+"-"+o.day:"hour"===e?s=o.year+"-"+o.month+"-"+o.day+" "+o.hour:"minute"===e&&(s=o.year+"-"+o.month+"-"+o.day+" "+o.hour+":"+o.minute),n[s]||(n[s]={value:r,data:[]}),n[s].data.push({value:r,index:i,scaleLabel:"",tipLabel:""})}var a,u=[];for(a in n)u.push(n[a]);return u.sort(function(t,e){return new Date(t.value).getTime()-new Date(e.value).getTime()}),u}(t,this._options.scale.type),t.length?(this._canvas.style.width=this._times.length*this._options.scale.space+"px",this.setDateTime(de(t),!1)):this.clear(),this},i.draw=function(){clearTimeout(this._timerObv),null!=(t=this._options)&&null!=(e=t.beforeDraw)&&e.call(t);var t=this._getMaxWidth(),e=this._canvasRoom.offsetWidth;this._canvasRoom.offsetWidth>t&&(e=t,this._offsetX.current=0,this._offsetX.pre=0),this._canvas.width=e,this._canvas.height=this._canvasHeight,this._canvas.style.width=e+"px",this._canvas.style.height=this._canvasHeight+"px",this._canvasRoom.style.height=this._canvasHeight+"px",this._ctx.fillStyle="transparent",this._ctx.fillRect(0,0,e,this._canvasHeight),this._drawScales(),this._drawProgress()},i._formatScale=function(t){var e;return this._options.scale.formatter?this._options.scale.formatter(t.value,t.index):(e=ve(new Date(t.value).getTime()),"year"===this._options.scale.type?r(e.year,4,"0")+"年":"month"===this._options.scale.type?r(e.year,4,"0")+"年"+r(e.month,2,"0")+"月":"day"===this._options.scale.type?r(e.month,2,"0")+"月"+r(e.day,2,"0")+"日":"hour"===this._options.scale.type?r(e.day,2,"0")+"日"+r(e.hour,2,"0")+"时":"minute"===this._options.scale.type?r(e.hour,2,"0")+"时"+r(e.minute,2,"0")+"分":t.value)},i._getMouseDatetime=function(t,e){var n,i=this._canvas.getBoundingClientRect(),t=Math.round(t-i.left),i=(t-=this._offsetX.current,Math.floor(t/this._options.scale.space)),r=this._times[i];if(r)return n=0,t<e?n=Math.floor(t%this._options.scale.space/(this._options.scale.space/r.data.length)):(n=Math.ceil(t%this._options.scale.space/(this._options.scale.space/r.data.length)))>r.data.length-1&&(n=0,r=this._times[++i]),null!=(e=r)&&null!=(t=e.data)&&t[n]||(i=this._times.length-1,n=(r=this._times[i]).data.length-1),r.data[n]},i._getMaxWidth=function(){var t,e=this._times.length*this._options.scale.space;return 1===(null==(t=X(this._times))?void 0:t.data.length)&&(e-=this._options.scale.space),e},i._drawProgress=function(){var t,e,n,i;this._currentTime&&(e=this._options.progress.size/2,this._ctx.beginPath(),this._ctx.lineWidth=this._options.progress.size,this._ctx.lineCap="round",this._ctx.strokeStyle=this._options.progress.backgroundStaticColor,this._ctx.moveTo(e,e),this._ctx.lineTo(this._canvas.offsetWidth-e,e),this._ctx.stroke(),this._ctx.closePath(),0<=(n=t=this._currentWidth+this._offsetX.current)&&(n-=(i=Math.max(this._options.progress.size,2))/2,n=Math.min(this._canvas.offsetWidth-e,n),n=Math.max(n,e),this._ctx.beginPath(),this._ctx.lineWidth=i,this._ctx.strokeStyle=this._options.progress.backgroundActiveColor,this._ctx.moveTo(e,e),this._ctx.lineTo(n,e),this._ctx.stroke(),this._ctx.closePath()),this._currentTime&&t<=this._canvasRoom.offsetWidth&&0<=t?(this._currentPopper.style.display="block",this._currentTime.tipLabel||(this._currentTime.tipLabel=null!=(e=null==(n=(i=this._options.label).formatter)?void 0:n.call(i,this._currentTime.value,this._currentTime.index))?e:this._currentTime.value),this._currentPopper.innerText=this._currentTime.tipLabel,i=this._canvas.getBoundingClientRect(),this._currentPopper.style.left=i.left+t-this._currentPopper.offsetWidth/2+"px",this._currentPopper.style.top=i.top-this._currentPopper.offsetHeight-8+"px"):this._currentPopper.style.display="none")},i._drawScales=function(){this._ctx.lineCap="butt",this._ctx.textBaseline="ideographic",this._ctx.fillStyle=this._options.scale.fontColor,this._ctx.font=this._options.scale.font.size+"px "+this._options.scale.font.family,this._ctx.lineWidth=1,this._ctx.strokeStyle=this._options.scale.lineColor,this._ctx.beginPath();for(var t,e,n,i=1;i<this._times.length;i++)i===this._times.length-1&&1===(null==(t=X(this._times))?void 0:t.data.length)||(t=this._times[i].data[0],e=this._options.scale.space*i-.5+this._offsetX.current,this._ctx.moveTo(e,0+this._options.progress.size+this._options.progress.padding),this._ctx.lineTo(e,this._options.scale.height+this._options.progress.size+this._options.progress.padding),this._ctx.stroke(),t.scaleLabel||(t.scaleLabel=this._formatScale(t)),n=this._ctx.measureText(t.scaleLabel).width,this._ctx.fillText(t.scaleLabel,e-Math.floor(n/2),this._canvasHeight));this._ctx.closePath()},i._scrollToCurrent=function(){this._currentTime&&(this._pressX=0,this._offsetX.pre=0,this._offsetX.current=this._offsetX.pre,this._onMouesmove({clientX:-this._currentWidth}),this._offsetX.pre=this._offsetX.current)},i.setDateTime=function(e,t){var n,i=this;if(clearTimeout(this._timerAuto),(null==(n=this._currentTime)?void 0:n.value)!==e)return this._locking?console.error('时间设置失败： "'+e+'"。上一个切换未完成！'):this._originTimes.some(function(t){return t===e})?(this._currentTime=function(t,e){for(var n,i,r=0;r<t.length;r++){for(var o=0;o<t[r].data.length;o++)if(t[r].data[o].value===e){i=!0,n=t[r].data[o];break}if(i)break}return n}(this._times,e),this._currentTime?(this._currentWidth=this._getTimeTickWidth(this._currentTime.value),t?(t=(n=this._currentWidth+this._offsetX.current)-this._canvasRoom.offsetWidth,n<0?(this._offsetX.current-=n,this._offsetX.pre-=n):0<t&&(this._offsetX.current-=t,this._offsetX.pre-=t),this.draw()):this._scrollToCurrent(),null!=(n=this._options)&&n.onChange&&(this._locking=!0,t={value:this._currentTime.value,start:de(this._originTimes),end:X(this._originTimes),prev:this._getPrevTime(),next:this._getNextTime()},this._options.onChange(t,function(){i._locking=!1,i._checkAutoPlay()}))):this.clear()):console.error('时间设置失败： "'+e+'" 不在列表中'),this},i.clear=function(){clearTimeout(this._timerObv),clearTimeout(this._timerAuto),this._mousein=!1,this._locking=!1,this._originTimes=[],this._currentWidth=0,this._pressX=0,this._ctx.clearRect(0,0,this._canvasRoom.offsetWidth,this._canvasHeight),this._currentPopper.style.display="none",this._previewPopper.style.display="none",this._canvas.style.width="0px",this._currentTime=undefined,document.removeEventListener("mouseup",this._onMouseup),document.removeEventListener("mousemove",this._onMouesmove)},i.dispose=function(){var t;this.stop(),null!=(t=this._mouseLeaveDebFunc)&&t.cancel(),this._obvHandler(),this.clear()},i=t,(e=[{key:"_minLeftSpace",get:function(){var t;return null!=(t=this._options.label.leftSpace)?t:Math.floor(this._canvas.offsetWidth/2)}}])&&D(i.prototype,e),n&&D(i,n),Object.defineProperty(i,"prototype",{writable:!1}),t}()}();
